<!DOCTYPE HTML>
<html lang="en">

<head>
  <title>SciGrade</title>
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8">
  <meta name="author" content="Alexander Sullivan" />
  <!-- jQuery using Google Hosted Library -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" crossorigin="anonymous">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>
  <!-- Stictch/mongoDB -->
  <script src="https://s3.amazonaws.com/stitch-sdks/js/library/v2/stable/stitch.min.js"></script>
  <!-- Google Material Icons -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <!-- Google Identity Platform Scripts -->
  <script src="https://apis.google.com/js/platform.js" async defer></script>
  <meta name="google-signin-client_id" content="1034277489697-g473uqcd0oc1c02td9off07b9mbe1353.apps.googleusercontent.com">
  <!-- tabletoCSV tool to create an option to download XML as CSV -->
  <script src="scripts\tabletoCSV\jquery.tabletoCSV.js"></script>
  <script>
    var studentParseNum;

    var googleName;
    var googleEmail;
    /**
     * Retrieves Google user information and stores it
     */
    function onSignIn(googleUser) {
      var profile = googleUser.getBasicProfile();
      googleName = profile.getName();
      googleEmail = profile.getEmail(); // This is null if the 'email' scope is not present.
      sendLogReg();
    }

    /**
     * Google signout
     */
    function signOut() {
      var auth2 = gapi.auth2.getAuthInstance();
      auth2.signOut();
    }
  </script>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-38961857-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'UA-38961857-6');
  </script>
  <!-- Custom scripts -->
  <script src="scripts\login.js"></script>
  <script src="scripts\crispr_scripts.js"></script>
  <link rel="stylesheet" href="styling\style.css" />
</head>

<body class="focusBody">
  <div class="navigationBar">
    <a href="http://scigrade.com">Home</a>
    <a class="active" href="systemrun.html">Run</a>
    <a href="about.html">About</a>
    <a class="logIO" data-toggle="modal" href="#accountModal" id="accountIO" onclick="openAccountManagement();" hidden> Account </a>
    <a class="logIO" id="logIO" href="#">
      <i class="material-icons" style="font-size:inherit;">&#xE7FD;</i> Login</a>
  </div>
  <div class="container focusContainer" role="tabpanel" id="mainContainer">
    <!-- Login and Regiseration -->
    <div>
      <div class="row">
        <div class="col-sm-1"></div>
        <div class="col-sm-10">
          <ul class="nav nav-tabs" id="logTabs" role="tablist">
            <li class="nav-item">
              <a class="nav-link" id="login-tab" data-toggle="tab" href="#login" role="tab" aria-controls="login">Login</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id="register-tab" data-toggle="tab" href="#register" role="tab" aria-controls="register">Register</a>
            </li>
          </ul>
          <div class="tab-content" id="logTabContent">
            <!-- Login -->
            <div role="tabpanel" class="tab-pane fade" id="login" aria-labelledby="login">
              <!-- First form the user sees for login which includes student number input -->
              <form id="loginForm">
                <div class="form-group">
                  <label for="InputStudentNumberLogin">Student number</label>
                  <input class="form-control" id="StudentNumberLogin" placeholder="1234567890" maxlength="10">
                  <small id="studentNumberLoginHelp" class="form-text text-muted">We'll never share your student number with anyone else.</small>
                </div>
                <button id="verifyLogin" type="button" class="btn btn-primary" onclick="loginVerify(document.getElementById('StudentNumberLogin').value)">Verify</button>
              </form>
              <!-- Actual login through Google Identity -->
              <form id="loginP2" style="display:none; margin-top:2%;">
                <div class="g-signin2" data-onsuccess="onSignIn"></div>
              </form>
            </div>
            <!-- Registeration -->
            <div role="tabpanel" class="tab-pane fade" id="register" aria-labelledby="register">
              <p> Registration is limited to students in the appropriate University of Toronto HMB class. If you are not in the appropriate HMB class, you cannot register for SciGrade. Though once you have registered for SciGrade, you now have a permanent account and can use SciGrade whenever you want.</p>
              <!-- First input form which includes student number and email -->
              <p id="pP1"> First, please verify that you are a student at the University of Toronto:</p>
              <form id="registerP1">
                <div class="form-group" id="studentID">
                  <label for="StudentNumber">Student number:</label>
                  <input class="form-control" id="StudentNumber" placeholder="1234567890" maxlength="10">
                  <small id="studentNumberHelp" class="form-text text-muted">Insert your 9 to 10 digit student number to verify you are a student at the University of Toronto.</small>
                </div>
                <div class="form-group" id="studentumail">
                  <label for="StudentEmail">Student uMail:</label>
                  <input type="email" class="form-control" id="StudentEmail" placeholder="first.last@mail.utoronto.ca">
                  <small id="studentEmailHelp" class="form-text text-muted">Insert your student uMail (email) from the University of Toronto.</small>
                </div>
                <button id="firstSubmit" type="button" class="btn btn-primary" onclick="checkStudentNumber(document.getElementById('StudentNumber').value, document.getElementById('StudentEmail').value);">Check</button>
              </form>
              <!-- Second which includes token ID -->
              <p id="pP2"></p>
              <form id="registerP2">
              </form>
              <!-- Third is registeration using Google Identity -->
              <p id="pP3"></p>
              <form id="registerP3" style="display:none;">
                <div class="g-signin2" data-onsuccess="onSignIn"></div>
              </form>
            </div>
          </div>
        </div>
        <div class="col-sm-1"></div>
      </div>
    </div>
  </div>

  <!-- Error with registeration modal -->
  <button id="errorRegButton" type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal" hidden>
    Error with registeration
  </button>
  <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Oops</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body" id="errorRegBody">
          <p id="errorRegContent">An error happened. If no error is being displayed here, you are not suppose to see this error (unexpected error).</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Feedback button -->
  <button id="feedbackButton" type="button" class="btn btn-primary" data-toggle="modal" data-target="#feedbackModal" hidden>
    Open feedback modal
  </button>
  <div class="modal fade" id="feedbackModal" tabindex="-1" role="dialog" aria-labelledby="feedbackModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="feedbackModalLabel">Done!</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body" id="feedbackBody">
          <p id="errorRegContent">Congratulations! Your answers have been submitted.</p>
          <p id="options_label"> Would you like to see feedback on your answers or start a new assignment? </p>
          <p>
            <button type="button" class="btn btn-primary" onclick="showFeedback(); $('#dismissFeedbackModal').click();">Feedback</button>
            <button type="button" class="btn btn-primary" onclick="possible_gene = 'eBFP'; select_Gene(); $('#dismissFeedbackModal').click();">Assignment</button>
          </p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal" id="dismissFeedbackModal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Account management button -->
  <button id="accountButton" type="button" class="btn btn-primary" data-toggle="modal" data-target="#accountModal" hidden>
    Open account management modal
  </button>
  <div class="modal fade" id="accountModal" tabindex="-1" role="dialog" aria-labelledby="accountModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document" style="max-width: 80%;">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="accountModalLabel">Account Management</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body" id="accountManagementBody">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal" id="dismissAccountModal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Admin send button -->
  <button id="adminSendButton" type="button" class="btn btn-primary" data-toggle="modal" data-target="#adminSendModal" hidden>
    Admin send modal
  </button>
  <div class="modal fade" id="adminSendModal" tabindex="-1" role="dialog" aria-labelledby="adminSendModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="adminSendModalLabel">SENT!</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body" id="adminSendBody" style="background-color: #98FB98;">
          Successfully sent to server!
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal" id="dismissAdminSendModal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Hidden student download modal -->
  <div id="hiddenDownloadModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel">
    <div class="modal-dialog modal-lg" style="width: 940px;">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" style="margin-top: -5px;" data-dismiss="modal">&times;</button>
        </div>
        <div class="modal-body">
          <div class="table-responsive json_modal_table" id="hiddenDownloadJSONCSV">
            <table id="hiddenDownloadModal_table" class="table"></table>
          </div>
        </div>
        <div class="modal-footer modal-footer-colour">
          <button type="button" class="btn btn-default modal-close" data-dismiss="modal" id="closemodal">Close</button>
        </div>
      </div>
    </div>
  </div>
</body>

</html>